<!--
  ~  Copyright 2016 Ripple Foundation C.I.C. Ltd
  ~  
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~  
  ~    http://www.apache.org/licenses/LICENSE-2.0

  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->

<div mc-popover mc-full-panel class="panel-group">
  <div class="panel panel-secondary">
    <div class="panel-heading">
      <div class="control-group right">
        <button class="btn btn-success btn-inverse btn-square hidden-xs hidden-sm btn-expand-panel" ng-click="changeFullPanel('details')"><i class="btn-icon fa fa-expand"></i><i class="btn-icon fa fa-compress"></i></button>
      </div>
      <h3 class="panel-title">Create Vitals</h3>
    </div>
    <div class="panel-body">
      <form name="vitalForm" class="form">
        <div class="panel-body-inner">
          <div class="vitals-group-wrapper">
            <div class="row-expand">
              <div class="col-expand-left">
                <div class="row">
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.respirationRate.$dirty) && vitalForm.respirationRate.$invalid, 'has-success': vitalForm.respirationRate.$valid && vitalForm.respirationRate.$dirty}">
                      <span ng-class="getHighlighterClass('respirationRate')"></span>  
                      <label class="vitals-label">Respiration Rate</label>
                      <div class="input-group vitals-holder popover-wrap" ng-class="vitalStatuses.respirationRate.type">
                        <input class="form-control input-sm" id="respirationRate" name="respirationRate" type="text" ng-model="vitalEdit.respirationRate" ng-change="changeVital(vitalEdit, 'respirationRate')" ng-pattern="pattern.number" required/>
                        <span class="vitals-addon popover-toggle" ng-click="togglePopover($event)">resps/min</span>
                        <mc-popover-vital title="Respiration Rate" labels="{{popoverLabels.respirationRate}}"></mc-popover-vital>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.respirationRate.$error.required || vitalForm.respirationRate.$invalid)">You must enter a correct value.</span>
                    </div>
                  </div>
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.oxygenSaturation.$dirty) && vitalForm.oxygenSaturation.$invalid, 'has-success': vitalForm.oxygenSaturation.$valid && vitalForm.oxygenSaturation.$dirty}">
                      <span ng-class="getHighlighterClass('oxygenSaturation')"></span>  
                      <label class="vitals-label">Oxygen Saturation</label>
                      <div class="input-group vitals-holder popover-wrap" ng-class="vitalStatuses.oxygenSaturation.type">
                        <input class="form-control input-sm" id="oxygenSaturation" name="oxygenSaturation" type="text" ng-model="vitalEdit.oxygenSaturation" ng-change="changeVital(vitalEdit, 'oxygenSaturation')" ng-pattern="pattern.numberPersent" required/>
                        <span class="vitals-addon popover-toggle" ng-click="togglePopover($event)">%</span>
                        <mc-popover-vital title="Oxygen Saturation" labels="{{popoverLabels.oxygenSaturation}}"></mc-popover-vital>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.oxygenSaturation.$error.required || vitalForm.oxygenSaturation.$invalid)">You must enter a correct value from 0 to 100.</span>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.oxygenSupplemental.$dirty) && vitalForm.oxygenSupplemental.$invalid, 'has-success': vitalForm.oxygenSupplemental.$valid && vitalForm.oxygenSupplemental.$dirty}">
                      <span ng-class="getHighlighterClass('oxygenSupplemental')"></span>  
                      <label class="vitals-label">Any Supplemental Oxygen</label>
                      <div class="input-holder">
                        <label class="switch">
                          <input id="oxygenSupplemental" type="checkbox" name="oxygenSupplemental" ng-model="vitalEdit.oxygenSupplemental" ng-change="changeVital(vitalEdit, 'oxygenSupplemental')">
                          <div class="slider">
                            <span class="text text-check-true">Yes</span>
                            <span class="text text-check-false">No</span>
                          </div>
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.heartRate.$dirty) && vitalForm.heartRate.$invalid, 'has-success': vitalForm.heartRate.$valid && vitalForm.heartRate.$dirty}">
                      <span ng-class="getHighlighterClass('heartRate')"></span>  
                      <label class="vitals-label">Heart Rate</label>
                      <div class="input-group vitals-holder popover-wrap" ng-class="vitalStatuses.heartRate.type">
                        <input class="form-control input-sm" id="heartRate" name="heartRate" type="text" ng-model="vitalEdit.heartRate" ng-change="changeVital(vitalEdit, 'heartRate')" ng-pattern="pattern.number" required/>
                        <span class="vitals-addon popover-toggle" ng-click="togglePopover($event)">bpm</span>
                        <mc-popover-vital title="Heart Rate" labels="{{popoverLabels.heartRate}}"></mc-popover-vital>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.heartRate.$error.required || vitalForm.heartRate.$invalid)">You must enter a correct value.</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-expand-right">
                <div class="row">
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.systolicBP.$dirty) && vitalForm.systolicBP.$invalid, 'has-success': vitalForm.systolicBP.$valid && vitalForm.systolicBP.$dirty}">
                      <span ng-class="getHighlighterClass('systolicBP')"></span>  
                      <label class="vitals-label">Systolic BP</label>
                      <div class="input-group vitals-holder popover-wrap" ng-class="vitalStatuses.systolicBP.type">
                        <input class="form-control input-sm" id="systolicBP" name="systolicBP" type="text" ng-model="vitalEdit.systolicBP" ng-change="changeVital(vitalEdit, 'systolicBP')" ng-pattern="pattern.number" required/>
                        <span class="vitals-addon popover-toggle" ng-click="togglePopover($event)">mmHg</span>
                        <mc-popover-vital title="Systolic BP" labels="{{popoverLabels.systolicBP}}"></mc-popover-vital>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.systolicBP.$error.required || vitalForm.systolicBP.$invalid)">You must enter a correct value.</span>
                    </div>
                  </div>
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.diastolicBP.$dirty) && vitalForm.diastolicBP.$invalid, 'has-success': vitalForm.diastolicBP.$valid && vitalForm.diastolicBP.$dirty}">
                      <span class="highlighter-not-vital"></span>  
                      <label class="vitals-label">Diastolic BP</label>
                      <div class="input-group vitals-holder">
                        <input class="form-control input-sm" id="diastolicBP" name="diastolicBP" type="text" ng-model="vitalEdit.diastolicBP" ng-pattern="pattern.number" required/>
                        <span class="vitals-addon">mmHg</span>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.diastolicBP.$error.required || vitalForm.diastolicBP.$invalid)">You must enter a correct value.</span>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.levelOfConsciousness.$dirty) && vitalForm.levelOfConsciousness.$invalid, 'has-success': vitalForm.levelOfConsciousness.$valid && vitalForm.levelOfConsciousness.$dirty}">
                      <span ng-class="getHighlighterClass('levelOfConsciousness')"></span>  
                      <label for="levelOfConsciousness" class="vitals-label">Level of Consciousness</label>
                      <div class="input-holder">
                        <div class="switch-group">
                          <label class="switch">
                            <input id="levelOfConsciousnessA" type="radio" name="levelOfConsciousness" value="Alert" ng-model="vitalEdit.levelOfConsciousness" ng-change="changeVital(vitalEdit, 'levelOfConsciousness')" required>
                            <div class="slider"><span class="text">A</span></div>
                          </label>
                          <label class="switch">
                            <input id="levelOfConsciousnessV" type="radio" name="levelOfConsciousness" value="Verbal" ng-model="vitalEdit.levelOfConsciousness" ng-change="changeVital(vitalEdit, 'levelOfConsciousness')" required>
                            <div class="slider"><span class="text">V</span></div>
                          </label>
                          <label class="switch">
                            <input id="levelOfConsciousnessP" type="radio" name="levelOfConsciousness" value="Pain" ng-model="vitalEdit.levelOfConsciousness" ng-change="changeVital(vitalEdit, 'levelOfConsciousness')" required>
                            <div class="slider"><span class="text">P</span></div>
                          </label>
                          <label class="switch">
                            <input id="levelOfConsciousnessU" type="radio" name="levelOfConsciousness" value="Unresponsive" ng-model="vitalEdit.levelOfConsciousness" ng-change="changeVital(vitalEdit, 'levelOfConsciousness')" required>
                            <div class="slider"><span class="text">U</span></div>
                          </label>
                        </div>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && vitalForm.levelOfConsciousness.$error.required">You must enter a value.</span>
                    </div>
                  </div>
                  <div class="col-xs-12 col-md-6">
                    <div class="vitals-group highlighter-wrapper" ng-class="{'has-error': (formSubmitted || vitalForm.temperature.$dirty) && vitalForm.temperature.$invalid, 'has-success': vitalForm.temperature.$valid && vitalForm.temperature.$dirty}">
                      <span ng-class="getHighlighterClass('temperature')"></span>  
                      <label class="vitals-label">Temperature</label>
                      <div class="input-group vitals-holder popover-wrap" ng-class="vitalStatuses.temperature.type">
                        <input class="form-control input-sm" id="temperature" name="temperature" type="text" ng-model="vitalEdit.temperature" ng-change="changeVital(vitalEdit, 'temperature')" ng-pattern="pattern.numberPoint" required/>
                        <span class="vitals-addon popover-toggle" ng-click="togglePopover($event)">c</span>
                        <mc-popover-vital title="Temperature" labels="{{popoverLabels.temperature}}"></mc-popover-vital>
                      </div>
                      <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.temperature.$error.required || vitalForm.temperature.$invalid)">You must enter a correct value.</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row-expand">
              <div class="col-expand-left">
                <div class="vitals-group highlighter-wrapper">
                  <span ng-class="getHighlighterClass('newsScore')"></span>  
                  <label class="vitals-label">NEWS Score</label>
                  <div class="input-holder vitals-holder" ng-class="vitalStatuses.newsScore.type">
                    <input class="form-control input-sm" id="newsScore" name="newsScore" type="text" ng-model="vitalEdit.newsScore" disabled/>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="panel-body-inner">
          <div class="form-group-wrapper">
            <div class="row-expand">
              <div class="col-expand-left">
                <div class="form-group" ng-class="{'has-error': (formSubmitted || vitalForm.author.$dirty) && vitalForm.author.$invalid, 'has-success': vitalForm.author.$valid && vitalForm.author.$dirty}">
                  <label for="author" class="control-label">Author</label>
                  <div class="input-holder">
                    <input type="text" class="form-control input-sm" id="author" name="author" ng-model="vitalEdit.author" required disabled/>
                  </div>
                  <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.author.$error.required || vitalForm.author.$invalid)">You must enter a correct value.</span>
                </div>
              </div>
              <div class="col-expand-right">
                <div class="form-group form-group-sm" ng-class="{'has-error': (formSubmitted || vitalForm.dateCreate.$dirty) && vitalForm.dateCreate.$invalid, 'has-success': vitalForm.dateCreate.$valid && vitalForm.dateCreate.$dirty}">
                  <label for="Date" class="control-label">Date</label>
                  <div class="inner-addon addon-left">
                    <div class="addon">
                      <i class="fa fa-calendar"></i>
                    </div>
                    <input type="text" class="form-control" id="dateCreate" name="dateCreate" ng-model="vitalEdit.dateCreate" ng-click="dateofSubmittedDatepicker($event, 'dateCreate')" uib-datepicker-popup="dd-MMM-y" is-open="dateCreate" required disabled/>
                  </div>
                  <span class="help-block animate-fade" ng-show="formSubmitted && (vitalForm.dateCreate.$error.required || vitalForm.dateCreate.$invalid)">You must enter a valid date.</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
      <div class="panel-control" ng-if="$ctrl.currentUser.permissions.indexOf('WRITE') !== -1">
        <div class="wrap-control-group">
          <div class="control-group right">
            <button class="btn btn-danger" ng-click="$ctrl.cancel()"><i class="btn-icon fa fa-ban"></i> <span class="btn-text">Cancel</span></button>
            <button class="btn btn-success" ng-click="create(vitalForm, vitalEdit)"><i class="btn-icon fa fa-check"></i> <span class="btn-text">Complete</span></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
